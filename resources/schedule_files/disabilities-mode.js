$(function(){function e(){"on"==r("disabilities-mode")&&i(),$(document).on("click","#visually_challenged, a.toggle-disabilities",function(e){e.preventDefault(),l("disabilities-mode","on"==r("disabilities-mode")?"off":"on",{expires:31536e4,path:"/"}),location.reload(!1)})}function i(){var e=$('<div id="top-panel"/>').insertBefore("#wrapper");e.load("/assets/template/js/disabilities-mode.htm",function(){t(),n("/assets/template/css/disabilities-mode.css"),a(),s()})}function t(){$(window).load(function(){var e=$("#wrapper div.mainslider *");e.off(),e.removeAttr("style"),$(window).off()}),$("link[rel=stylesheet], style, script").remove(),$("*").removeAttr("style"),$.fx.off=!1}function n(e){var i=$('<link rel="stylesheet" type="text/css" href="'+e+'">');$("head").append(i)}function a(){var e=$("#control-panel span.set"),i=r("disabilities-settings")?JSON.parse(r("disabilities-settings")):{};e.on("click",function(){var e=$(this),i=$("span.set",e.parent());e.data("href")&&$(e.data("href")).toggleClass("hidden"),i.length>1&&i.removeClass("selected"),e.toggleClass("selected"),e.data("set")&&e.trigger("change")}).on("change",function(){var e=$(this),t=$("span.set",e.parent()),n=e.data("set").split(":"),a=n[0],s=n[1];1==t.length&&(s=!e.hasClass("selected")),$("body").attr("class",function(e,i){return i.replace(new RegExp("(^|\\s)page-"+a+"\\S+","g"),"")}).addClass("page-"+a+"-"+s),i[a]=s,l("disabilities-settings",JSON.stringify(i),{expires:31536e4,path:"/"})}).on("init",function(){var e=$(this),t=e.data("set").split(":"),n=t[0],a=t[1],s=i[n]+"";return"undefined"==s?void(e.hasClass("selected")&&e.trigger("click")):void(a==s&&e.trigger("click"))}).filter("[data-set]").trigger("init")}function s(){var e=$("body.main #wrapper");$("ul.mainmenu").attr("id","mainmenu").prepend('<li><a href="/">Главная</a></li>'),$("body.main ul.mainmenu li:first").addClass("active"),$("#sideLeft ul.leftmenu:first").attr("id","submenu").addClass("mainmenu submenu").insertAfter("h1"),$("#submenu").length||$("div.menu:first","#wrapper").attr("id","submenu").addClass("mainmenu submenu").find("a").wrap("<span></span>").end().insertAfter("h1"),$("#link-submenu").toggleClass("hidden",!$("#submenu").length),$("#wrapper h1").length&&($("#wrapper h1:first").attr("id","h1"),$("#link-content").attr("href","#h1")),$("h1, h2, h3","body:not(.main) #wrapper").addClass("h3"),$("div.h3",e).append(":"),$("#mainslider").before('<div class="h3">Главное:</div>'),$("div.news a.allArticles",e).text("Посмотреть все новости"),$("div.anounce a.allArticles",e).text("Посмотреть все анонсы"),$("#footer div.copyright div.inner").append('<div class="right"><a href="." class="toggle-disabilities" rel="nofollow"><i class="icon icon-disabilities"></i> <span class="pseudo-link">Обычная версия</span></a></div>'),$("#menu-panel a.toggle-disabilities, #footer a.toggle-disabilities").map(function(){this.href=location.href}),$("br").replaceWith(" <br>"),$(window).load(function(){$("div.bx-viewport br").replaceWith(" <br>"),$("body.main div.wrapSlider div.h3").length&&($("body.main div.wrapSlider div.h3:first").attr("id","h1"),$("#link-content").attr("href","#h1"))}),$("#menu-panel div.right a").on("click",function(e){if(e.preventDefault(),$(this.hash).length){var i=$("#top-panel").height();$("html, body").animate({scrollTop:$(this.hash).offset().top-i},1e3)}})}function r(e){var i=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return i?decodeURIComponent(i[1]):void 0}function l(e,i,t){t=t||{};var n=t.expires;if("number"==typeof n&&n){var a=new Date;a.setTime(a.getTime()+1e3*n),n=t.expires=a}n&&n.toUTCString&&(t.expires=n.toUTCString()),i=encodeURIComponent(i);var s=e+"="+i;for(var r in t){s+="; "+r;var l=t[r];l!==!0&&(s+="="+l)}document.cookie=s}e()});